Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t1_VM1\" | grep -w \"t1VM1if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t1_VM1\" --type direct --config ; fi\n", "delta": "0:00:00.053325", "end": "2019-11-22 06:54:29.389384", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "rc": 0, "start": "2019-11-22 06:54:29.336059", "stderr": "", "stderr_lines": [], "stdout": "macvtap0   direct     t1VM1if1   rtl8139     52:54:00:68:4a:91\nInterface detached successfully", "stdout_lines": ["macvtap0   direct     t1VM1if1   rtl8139     52:54:00:68:4a:91", "Interface detached successfully"]}

TASK [Shutdown VMs] *****************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t1_VM1\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t1_VM1\" ; fi\n", "delta": "0:00:00.148138", "end": "2019-11-22 06:54:29.805856", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "rc": 0, "start": "2019-11-22 06:54:29.657718", "stderr": "", "stderr_lines": [], "stdout": "Domain t1_VM1 is being shutdown", "stdout_lines": ["Domain t1_VM1 is being shutdown"]}

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [localhost] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

PLAY [worker] ***********************************************************************************************************************************************

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [99.99.99.2] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

TASK [Migrate VM images] ************************************************************************************************************************************
FAILED - RETRYING: Migrate VM images (3 retries left).
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "attempts": 2, "changed": true, "checksum": "af758c01704308a1607924de9c97a11ab32d2f96", "dest": "/var/lib/libvirt/images/t1_VM1.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "md5sum": "8b924b3488a3ef0865ab097e83d283bc", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1574405671.45-206401471053745/source", "state": "file", "uid": 0}

TASK [Migrate VM templates] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "280a0e26a14226944246cd0177a779fd802836c4", "dest": "/etc/libvirt/qemu/t1_VM1.xml", "gid": 0, "group": "root", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "md5sum": "c63170d04c1f5f65fa5093a681fbc5f9", "mode": "0644", "owner": "root", "size": 4252, "src": "/root/.ansible/tmp/ansible-tmp-1574406281.77-240095681257858/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.041705", "end": "2019-11-22 07:04:42.641480", "rc": 0, "start": "2019-11-22 07:04:42.599775", "stderr": "", "stderr_lines": [], "stdout": "t1_VM4", "stdout_lines": ["t1_VM4"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t1_VM1", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1_m\" ; if [ $? -ne 0 ] ; then ip link add \"t1VM1if1_m\" type veth peer name \"t1br1if1_m\" ; fi\nip link set dev \"t1br1if1_m\" up\nip link set dev \"t1VM1if1_m\" up\n", "delta": "0:00:00.023202", "end": "2019-11-22 07:04:44.948175", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "rc": 0, "start": "2019-11-22 07:04:44.924973", "stderr": "Device \"t1br1if1_m\" does not exist.", "stderr_lines": ["Device \"t1br1if1_m\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1_m\" ; if [ $? -eq 0 ] ; then ip link set \"t1br1if1_m\" netns \"t1ns1\" ; fi\nip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1br1if1_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1br1if1_m\" ; fi\nvirsh domiflist \"t1_VM1\" | grep -w \"t1VM1if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t1_VM1\" direct \"t1VM1if1_m\" --live --persistent --mac \"52:54:00:68:4a:91\" ; fi\n", "delta": "0:00:00.371594", "end": "2019-11-22 07:04:45.584963", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "rc": 0, "start": "2019-11-22 07:04:45.213369", "stderr": "", "stderr_lines": [], "stdout": "25: t1br1if1_m@t1VM1if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether be:6a:42:e6:5c:be brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["25: t1br1if1_m@t1VM1if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether be:6a:42:e6:5c:be brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}

TASK [Make all interfaces UP] *******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link set dev \"t1br1if1_m\" up\nip link set dev \"t1VM1if1_m\" up\n", "delta": "0:00:00.052799", "end": "2019-11-22 07:04:45.873489", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "rc": 0, "start": "2019-11-22 07:04:45.820690", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY [main] *************************************************************************************************************************************************

TASK [pause] ************************************************************************************************************************************************
Pausing for 60 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [localhost] => {"changed": false, "delta": 60, "echo": true, "rc": 0, "start": "2019-11-22 07:04:45.960265", "stderr": "", "stdout": "Paused for 1.0 minutes", "stop": "2019-11-22 07:05:45.960555", "user_input": ""}

TASK [Undefine Migrated VM at C1] ***************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM1if1_m', u'vm_mac': u'52:54:00:68:4a:91', u'name': u't1_VM1', u'vmif': u't1VM1if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t1_VM1\"\n", "delta": "0:00:00.028436", "end": "2019-11-22 07:05:46.189851", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM1", "vm_mac": "52:54:00:68:4a:91", "vmif": "t1VM1if1", "vmif_m": "t1VM1if1_m"}], "rc": 0, "start": "2019-11-22 07:05:46.161415", "stderr": "", "stderr_lines": [], "stdout": "Domain t1_VM1 has been undefined", "stdout_lines": ["Domain t1_VM1 has been undefined"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=10   changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=5    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t1_VM4\" | grep -w \"t1VM4if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t1_VM4\" --type direct --config ; fi\n", "delta": "0:00:00.064367", "end": "2019-11-22 07:05:48.374253", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "rc": 0, "start": "2019-11-22 07:05:48.309886", "stderr": "", "stderr_lines": [], "stdout": "macvtap0   direct     t1VM4if1   rtl8139     52:54:00:a7:c6:7e\nInterface detached successfully", "stdout_lines": ["macvtap0   direct     t1VM4if1   rtl8139     52:54:00:a7:c6:7e", "Interface detached successfully"]}

TASK [Shutdown VMs] *****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t1_VM4\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t1_VM4\" ; fi\n", "delta": "0:00:00.193926", "end": "2019-11-22 07:05:48.892140", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "rc": 0, "start": "2019-11-22 07:05:48.698214", "stderr": "", "stderr_lines": [], "stdout": "Domain t1_VM4 is being shutdown", "stdout_lines": ["Domain t1_VM4 is being shutdown"]}

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [99.99.99.2] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

TASK [Migrate VM images] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "6eb3a7049ab8e3d211cbde1634a21785d59e1710", "dest": "/var/lib/libvirt/images/t1_VM4.qcow2", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "md5sum": "ba68fbc5d5e5e2cebaa159a62a382f79", "remote_checksum": "7498c7cced2bf19fc24e9ca4e7d19f65481487c7", "remote_md5sum": null}

TASK [Migrate VM templates] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "afee72780c49aeb6633ee6257ec06acbd1b905ba", "dest": "/etc/libvirt/qemu/t1_VM4.xml", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "md5sum": "88fd946705f0535e59159433b580c837", "remote_checksum": "afee72780c49aeb6633ee6257ec06acbd1b905ba", "remote_md5sum": null}

PLAY [main] *************************************************************************************************************************************************

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.023875", "end": "2019-11-22 07:10:46.050823", "rc": 0, "start": "2019-11-22 07:10:46.026948", "stderr": "", "stderr_lines": [], "stdout": "t1_VM2\nt1_VM3", "stdout_lines": ["t1_VM2", "t1_VM3"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t1_VM4", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1_m\" ; if [ $? -ne 0 ] ; then ip link add \"t1VM4if1_m\" type veth peer name \"t1br1if1_m\" ; fi\nip link set dev \"t1br1if1_m\" up\nip link set dev \"t1VM4if1_m\" up\n", "delta": "0:00:00.030454", "end": "2019-11-22 07:10:48.018423", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "rc": 0, "start": "2019-11-22 07:10:47.987969", "stderr": "Device \"t1br1if1_m\" does not exist.", "stderr_lines": ["Device \"t1br1if1_m\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t1br1if1_m\" ; if [ $? -eq 0 ] ; then ip link set \"t1br1if1_m\" netns \"t1ns1\" ; fi\nip netns exec \"t1ns1\" brctl show \"t1br1\" | grep -w 't1br1if1_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t1ns1\" brctl addif \"t1br1\" \"t1br1if1_m\" ; fi\nvirsh domiflist \"t1_VM4\" | grep -w \"t1VM4if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t1_VM4\" direct \"t1VM4if1_m\" --live --persistent --mac \"52:54:00:a7:c6:7e\" ; fi\n", "delta": "0:00:00.331250", "end": "2019-11-22 07:10:48.518053", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "rc": 0, "start": "2019-11-22 07:10:48.186803", "stderr": "", "stderr_lines": [], "stdout": "35: t1br1if1_m@t1VM4if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 1a:f2:40:c4:19:88 brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["35: t1br1if1_m@t1VM4if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 1a:f2:40:c4:19:88 brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}

TASK [Make all interfaces UP] *******************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t1ns1\" ip link set dev \"t1br1if1_m\" up\nip link set dev \"t1VM4if1_m\" up\n", "delta": "0:00:00.045791", "end": "2019-11-22 07:10:48.715346", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "rc": 0, "start": "2019-11-22 07:10:48.669555", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY [worker] ***********************************************************************************************************************************************

TASK [pause] ************************************************************************************************************************************************
Pausing for 60 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [99.99.99.2] => {"changed": false, "delta": 60, "echo": true, "rc": 0, "start": "2019-11-22 07:10:48.774109", "stderr": "", "stdout": "Paused for 1.0 minutes", "stop": "2019-11-22 07:11:48.774449", "user_input": ""}

TASK [Undefine Migrated VM at C2] ***************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't1ns1', u'bridge_name': u't1br1'}, {u'vmif_m': u't1VM4if1_m', u'vm_mac': u'52:54:00:a7:c6:7e', u'name': u't1_VM4', u'vmif': u't1VM4if1', u'brif_m': u't1br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t1_VM4\"\n", "delta": "0:00:00.027026", "end": "2019-11-22 07:11:49.862820", "item": [{"bridge_name": "t1br1", "ns_name": "t1ns1"}, {"brif_m": "t1br1if1_m", "name": "t1_VM4", "vm_mac": "52:54:00:a7:c6:7e", "vmif": "t1VM4if1", "vmif_m": "t1VM4if1_m"}], "rc": 0, "start": "2019-11-22 07:11:49.835794", "stderr": "", "stderr_lines": [], "stdout": "Domain t1_VM4 has been undefined", "stdout_lines": ["Domain t1_VM4 has been undefined"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=7    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=7    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t2_VM1\" | grep -w \"t2VM1if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t2_VM1\" --type direct --config ; fi\n", "delta": "0:00:00.056176", "end": "2019-12-05 08:45:12.645179", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:45:12.589003", "stderr": "", "stderr_lines": [], "stdout": "macvtap3   direct     t2VM1if1   rtl8139     52:54:00:a0:43:9f\nInterface detached successfully", "stdout_lines": ["macvtap3   direct     t2VM1if1   rtl8139     52:54:00:a0:43:9f", "Interface detached successfully"]}

TASK [Shutdown VMs] *****************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t2_VM1\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t2_VM1\" ; fi\n", "delta": "0:00:00.224471", "end": "2019-12-05 08:45:13.138606", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:45:12.914135", "stderr": "", "stderr_lines": [], "stdout": "Domain t2_VM1 is being shutdown", "stdout_lines": ["Domain t2_VM1 is being shutdown"]}

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [localhost] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

PLAY [worker] ***********************************************************************************************************************************************

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [99.99.99.2] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

TASK [Migrate VM images] ************************************************************************************************************************************
FAILED - RETRYING: Migrate VM images (3 retries left).
changed: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "attempts": 2, "changed": true, "checksum": "8cce580730ecf4cf00258a6a0dc79e9df7c5c65f", "dest": "/var/lib/libvirt/images/t2_VM1.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "md5sum": "5db025f05caad297beb26e2d2eccf34f", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575535515.19-21977204487864/source", "state": "file", "uid": 0}

TASK [Migrate VM templates] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "d5e5348cb6eaf56313d82dde7bdee0214cbdf3f7", "dest": "/etc/libvirt/qemu/t2_VM1.xml", "gid": 0, "group": "root", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "md5sum": "af3db6089d6e0e8686eb1ca7fcf301eb", "mode": "0644", "owner": "root", "size": 4252, "src": "/root/.ansible/tmp/ansible-tmp-1575536133.07-252968492670180/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.041970", "end": "2019-12-05 08:55:34.004705", "rc": 0, "start": "2019-12-05 08:55:33.962735", "stderr": "", "stderr_lines": [], "stdout": "t1_VM4\nt2_VM4", "stdout_lines": ["t1_VM4", "t2_VM4"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t2_VM1", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1_m\" ; if [ $? -ne 0 ] ; then ip link add \"t2VM1if1_m\" type veth peer name \"t2br1if1_m\" ; fi\nip link set dev \"t2br1if1_m\" up\nip link set dev \"t2VM1if1_m\" up\n", "delta": "0:00:00.060834", "end": "2019-12-05 08:55:36.374734", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:55:36.313900", "stderr": "Device \"t2br1if1_m\" does not exist.", "stderr_lines": ["Device \"t2br1if1_m\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t2br1if1_m\" ; if [ $? -eq 0 ] ; then ip link set \"t2br1if1_m\" netns \"t2ns1\" ; fi\nip netns exec \"t2ns1\" brctl show \"t2br1\" | grep -w 't2br1if1_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t2ns1\" brctl addif \"t2br1\" \"t2br1if1_m\" ; fi\nvirsh domiflist \"t2_VM1\" | grep -w \"t2VM1if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t2_VM1\" direct \"t2VM1if1_m\" --live --persistent --mac \"52:54:00:a0:43:9f\" ; fi\n", "delta": "0:00:00.356008", "end": "2019-12-05 08:55:37.008665", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:55:36.652657", "stderr": "", "stderr_lines": [], "stdout": "68: t2br1if1_m@t2VM1if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether d6:a3:a3:76:6a:f6 brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["68: t2br1if1_m@t2VM1if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether d6:a3:a3:76:6a:f6 brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}

TASK [Make all interfaces UP] *******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t2ns1\" ip link set dev \"t2br1if1_m\" up\nip link set dev \"t2VM1if1_m\" up\n", "delta": "0:00:00.040475", "end": "2019-12-05 08:55:37.283975", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:55:37.243500", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY [main] *************************************************************************************************************************************************

TASK [pause] ************************************************************************************************************************************************
Pausing for 60 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [localhost] => {"changed": false, "delta": 60, "echo": true, "rc": 0, "start": "2019-12-05 08:55:37.369413", "stderr": "", "stdout": "Paused for 1.0 minutes", "stop": "2019-12-05 08:56:37.369761", "user_input": ""}

TASK [Undefine Migrated VM at C1] ***************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'52:54:00:a0:43:9f', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t2_VM1\"\n", "delta": "0:00:00.104627", "end": "2019-12-05 08:56:37.716543", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "52:54:00:a0:43:9f", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:56:37.611916", "stderr": "", "stderr_lines": [], "stdout": "Domain t2_VM1 has been undefined", "stdout_lines": ["Domain t2_VM1 has been undefined"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=10   changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=5    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t2_VM1\" | grep -w \"t2VM1if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t2_VM1\" --type direct --config ; fi\n", "delta": "0:00:00.018415", "end": "2019-12-05 08:56:39.846290", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "rc": 0, "start": "2019-12-05 08:56:39.827875", "stderr": "error: failed to get domain 't2_VM1'\nerror: Domain not found: no domain with matching name 't2_VM1'", "stderr_lines": ["error: failed to get domain 't2_VM1'", "error: Domain not found: no domain with matching name 't2_VM1'"], "stdout": "", "stdout_lines": []}

TASK [Shutdown VMs] *****************************************************************************************************************************************
failed: [localhost] (item=[{u'ns_name': u't2ns1', u'bridge_name': u't2br1'}, {u'vmif_m': u't2VM1if1_m', u'vm_mac': u'', u'name': u't2_VM1', u'vmif': u't2VM1if1', u'brif_m': u't2br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t2_VM1\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t2_VM1\" ; fi\n", "delta": "0:00:00.035690", "end": "2019-12-05 08:56:40.120255", "item": [{"bridge_name": "t2br1", "ns_name": "t2ns1"}, {"brif_m": "t2br1if1_m", "name": "t2_VM1", "vm_mac": "", "vmif": "t2VM1if1", "vmif_m": "t2VM1if1_m"}], "msg": "non-zero return code", "rc": 1, "start": "2019-12-05 08:56:40.084565", "stderr": "error: failed to get domain 't2_VM1'\nerror: Domain not found: no domain with matching name 't2_VM1'", "stderr_lines": ["error: failed to get domain 't2_VM1'", "error: Domain not found: no domain with matching name 't2_VM1'"], "stdout": "", "stdout_lines": []}

PLAY RECAP **************************************************************************************************************************************************
localhost                  : ok=1    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [main] *************************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t14_VM2\" | grep -w \"t14VM2if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t14_VM2\" --type direct --config ; fi\n", "delta": "0:00:00.049050", "end": "2019-12-05 10:39:53.647082", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "rc": 0, "start": "2019-12-05 10:39:53.598032", "stderr": "", "stderr_lines": [], "stdout": "macvtap6   direct     t14VM2if1  rtl8139     52:54:00:48:58:b8\nInterface detached successfully", "stdout_lines": ["macvtap6   direct     t14VM2if1  rtl8139     52:54:00:48:58:b8", "Interface detached successfully"]}

TASK [Shutdown VMs] *****************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t14_VM2\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t14_VM2\" ; fi\n", "delta": "0:00:00.144778", "end": "2019-12-05 10:39:54.016179", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "rc": 0, "start": "2019-12-05 10:39:53.871401", "stderr": "", "stderr_lines": [], "stdout": "Domain t14_VM2 is being shutdown", "stdout_lines": ["Domain t14_VM2 is being shutdown"]}

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [localhost] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

PLAY [worker] ***********************************************************************************************************************************************

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [99.99.99.2] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

TASK [Migrate VM images] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "attempts": 1, "changed": true, "checksum": "93a5f6fed88d31b59d587fd1812af2bc7f55ea1c", "dest": "/var/lib/libvirt/images/t14_VM2.qcow2", "gid": 0, "group": "root", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "md5sum": "b298f1fe3f1b8ba8c846ea9311bb530b", "mode": "0644", "owner": "root", "size": 10739318784, "src": "/root/.ansible/tmp/ansible-tmp-1575542395.79-138622043772836/source", "state": "file", "uid": 0}

TASK [Migrate VM templates] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "4910eea9ed2e35929e7735d8ca2bb9be4de323ca", "dest": "/etc/libvirt/qemu/t14_VM2.xml", "gid": 0, "group": "root", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "md5sum": "225fb9fd793acaaf1721ce666456a9d9", "mode": "0644", "owner": "root", "size": 4255, "src": "/root/.ansible/tmp/ansible-tmp-1575542676.4-51872226379118/source", "state": "file", "uid": 0}

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [99.99.99.2] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.024524", "end": "2019-12-05 10:44:37.300031", "rc": 0, "start": "2019-12-05 10:44:37.275507", "stderr": "", "stderr_lines": [], "stdout": "t1_VM4\nt2_VM4\nt2_VM1\nt14_VM4\nt14_VM3", "stdout_lines": ["t1_VM4", "t2_VM4", "t2_VM1", "t14_VM4", "t14_VM3"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t14_VM2", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t14br1if2_m\" ; if [ $? -ne 0 ] ; then ip link add \"t14VM2if1_m\" type veth peer name \"t14br1if2_m\" ; fi\nip link set dev \"t14br1if2_m\" up\nip link set dev \"t14VM2if1_m\" up\n", "delta": "0:00:00.156137", "end": "2019-12-05 10:44:39.938731", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "rc": 0, "start": "2019-12-05 10:44:39.782594", "stderr": "Device \"t14br1if2_m\" does not exist.", "stderr_lines": ["Device \"t14br1if2_m\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t14br1if2_m\" ; if [ $? -eq 0 ] ; then ip link set \"t14br1if2_m\" netns \"t14ns1\" ; fi\nip netns exec \"t14ns1\" brctl show \"t14br1\" | grep -w 't14br1if2_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t14ns1\" brctl addif \"t14br1\" \"t14br1if2_m\" ; fi\nvirsh domiflist \"t14_VM2\" | grep -w \"t14VM2if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t14_VM2\" direct \"t14VM2if1_m\" --live --persistent --mac \"52:54:00:48:58:b8\" ; fi\n", "delta": "0:00:00.402278", "end": "2019-12-05 10:44:40.652940", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "rc": 0, "start": "2019-12-05 10:44:40.250662", "stderr": "", "stderr_lines": [], "stdout": "93: t14br1if2_m@t14VM2if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 0e:6d:da:ad:ef:11 brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["93: t14br1if2_m@t14VM2if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 0e:6d:da:ad:ef:11 brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}

TASK [Make all interfaces UP] *******************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t14ns1\" ip link set dev \"t14br1if2_m\" up\nip link set dev \"t14VM2if1_m\" up\n", "delta": "0:00:00.051976", "end": "2019-12-05 10:44:41.001577", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "rc": 0, "start": "2019-12-05 10:44:40.949601", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

PLAY [main] *************************************************************************************************************************************************

TASK [pause] ************************************************************************************************************************************************
Pausing for 60 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [localhost] => {"changed": false, "delta": 60, "echo": true, "rc": 0, "start": "2019-12-05 10:44:41.100252", "stderr": "", "stdout": "Paused for 1.0 minutes", "stop": "2019-12-05 10:45:41.101950", "user_input": ""}

TASK [Undefine Migrated VM at C1] ***************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM2if1_m', u'vm_mac': u'52:54:00:48:58:b8', u'name': u't14_VM2', u'vmif': u't14VM2if1', u'brif_m': u't14br1if2_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t14_VM2\"\n", "delta": "0:00:00.023705", "end": "2019-12-05 10:45:41.348955", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if2_m", "name": "t14_VM2", "vm_mac": "52:54:00:48:58:b8", "vmif": "t14VM2if1", "vmif_m": "t14VM2if1_m"}], "rc": 0, "start": "2019-12-05 10:45:41.325250", "stderr": "", "stderr_lines": [], "stdout": "Domain t14_VM2 has been undefined", "stdout_lines": ["Domain t14_VM2 has been undefined"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=10   changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=5    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t14_VM4\" | grep -w \"t14VM4if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t14_VM4\" --type direct --config ; fi\n", "delta": "0:00:00.048453", "end": "2019-12-05 10:45:43.479865", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "rc": 0, "start": "2019-12-05 10:45:43.431412", "stderr": "", "stderr_lines": [], "stdout": "macvtap3   direct     t14VM4if1  rtl8139     52:54:00:c4:9a:3d\nInterface detached successfully", "stdout_lines": ["macvtap3   direct     t14VM4if1  rtl8139     52:54:00:c4:9a:3d", "Interface detached successfully"]}
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t14_VM3\" | grep -w \"t14VM3if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t14_VM3\" --type direct --config ; fi\n", "delta": "0:00:00.053490", "end": "2019-12-05 10:45:43.887781", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "rc": 0, "start": "2019-12-05 10:45:43.834291", "stderr": "", "stderr_lines": [], "stdout": "macvtap4   direct     t14VM3if1  rtl8139     52:54:00:52:89:bf\nInterface detached successfully", "stdout_lines": ["macvtap4   direct     t14VM3if1  rtl8139     52:54:00:52:89:bf", "Interface detached successfully"]}

TASK [Shutdown VMs] *****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t14_VM4\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t14_VM4\" ; fi\n", "delta": "0:00:00.161063", "end": "2019-12-05 10:45:44.414592", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "rc": 0, "start": "2019-12-05 10:45:44.253529", "stderr": "", "stderr_lines": [], "stdout": "Domain t14_VM4 is being shutdown", "stdout_lines": ["Domain t14_VM4 is being shutdown"]}
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t14_VM3\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t14_VM3\" ; fi\n", "delta": "0:00:00.160756", "end": "2019-12-05 10:45:44.936031", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "rc": 0, "start": "2019-12-05 10:45:44.775275", "stderr": "", "stderr_lines": [], "stdout": "Domain t14_VM3 is being shutdown", "stdout_lines": ["Domain t14_VM3 is being shutdown"]}

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [99.99.99.2] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

TASK [Migrate VM images] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "e02ec72d6ad4de3e5ed368674608977fdc044147", "dest": "/var/lib/libvirt/images/t14_VM4.qcow2", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "md5sum": "5f9dcc66e78d970150e776558ba412b8", "remote_checksum": "8203a5910b3d0db83b951e6b0a18669b1f04cfb7", "remote_md5sum": null}
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "0e277aa83b0c99911a1b907df3cd4f40322ac90e", "dest": "/var/lib/libvirt/images/t14_VM3.qcow2", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "md5sum": "73304e532a88a4cceb21c9a5d5b287c5", "remote_checksum": "0e277aa83b0c99911a1b907df3cd4f40322ac90e", "remote_md5sum": null}

TASK [Migrate VM templates] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "8eb11231353e7bd95d10e27c80ca6d3f8ca7fc40", "dest": "/etc/libvirt/qemu/t14_VM4.xml", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "md5sum": "b9f82a4b6cc425478e17a19856323bd5", "remote_checksum": "8eb11231353e7bd95d10e27c80ca6d3f8ca7fc40", "remote_md5sum": null}
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "330e921869314b75a315234d3909629dedac46a9", "dest": "/etc/libvirt/qemu/t14_VM3.xml", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "md5sum": "2759da8bd8c6e294492c969a6cc159a0", "remote_checksum": "330e921869314b75a315234d3909629dedac46a9", "remote_md5sum": null}

PLAY [main] *************************************************************************************************************************************************

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.071049", "end": "2019-12-05 10:56:10.460555", "rc": 0, "start": "2019-12-05 10:56:10.389506", "stderr": "", "stderr_lines": [], "stdout": "t1_VM1\nt1_VM2\nt1_VM3\nt2_VM2\nt2_VM3\nt14_VM1", "stdout_lines": ["t1_VM1", "t1_VM2", "t1_VM3", "t2_VM2", "t2_VM3", "t14_VM1"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t14_VM4", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}
changed: [localhost] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t14_VM3", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}]}
ok: [localhost] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}]}
ok: [localhost] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t14br1if1_m\" ; if [ $? -ne 0 ] ; then ip link add \"t14VM4if1_m\" type veth peer name \"t14br1if1_m\" ; fi\nip link set dev \"t14br1if1_m\" up\nip link set dev \"t14VM4if1_m\" up\n", "delta": "0:00:00.047153", "end": "2019-12-05 10:56:14.492693", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "rc": 0, "start": "2019-12-05 10:56:14.445540", "stderr": "Device \"t14br1if1_m\" does not exist.", "stderr_lines": ["Device \"t14br1if1_m\" does not exist."], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t14br2if1_m\" ; if [ $? -ne 0 ] ; then ip link add \"t14VM3if1_m\" type veth peer name \"t14br2if1_m\" ; fi\nip link set dev \"t14br2if1_m\" up\nip link set dev \"t14VM3if1_m\" up\n", "delta": "0:00:00.027208", "end": "2019-12-05 10:56:14.694003", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "rc": 0, "start": "2019-12-05 10:56:14.666795", "stderr": "Device \"t14br2if1_m\" does not exist.", "stderr_lines": ["Device \"t14br2if1_m\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t14br1if1_m\" ; if [ $? -eq 0 ] ; then ip link set \"t14br1if1_m\" netns \"t14ns1\" ; fi\nip netns exec \"t14ns1\" brctl show \"t14br1\" | grep -w 't14br1if1_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t14ns1\" brctl addif \"t14br1\" \"t14br1if1_m\" ; fi\nvirsh domiflist \"t14_VM4\" | grep -w \"t14VM4if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t14_VM4\" direct \"t14VM4if1_m\" --live --persistent --mac \"52:54:00:c4:9a:3d\" ; fi\n", "delta": "0:00:00.452242", "end": "2019-12-05 10:56:15.354460", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "rc": 0, "start": "2019-12-05 10:56:14.902218", "stderr": "", "stderr_lines": [], "stdout": "167: t14br1if1_m@t14VM4if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 4a:3a:a5:3d:0a:1e brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["167: t14br1if1_m@t14VM4if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 4a:3a:a5:3d:0a:1e brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}
changed: [localhost] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t14br2if1_m\" ; if [ $? -eq 0 ] ; then ip link set \"t14br2if1_m\" netns \"t14ns2\" ; fi\nip netns exec \"t14ns2\" brctl show \"t14br2\" | grep -w 't14br2if1_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t14ns2\" brctl addif \"t14br2\" \"t14br2if1_m\" ; fi\nvirsh domiflist \"t14_VM3\" | grep -w \"t14VM3if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t14_VM3\" direct \"t14VM3if1_m\" --live --persistent --mac \"52:54:00:52:89:bf\" ; fi\n", "delta": "0:00:00.333316", "end": "2019-12-05 10:56:15.855118", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "rc": 0, "start": "2019-12-05 10:56:15.521802", "stderr": "Error: argument \"t14ns2\" is wrong: Invalid \"netns\" value\n\nCannot open network namespace \"t14ns2\": No such file or directory\nCannot open network namespace \"t14ns2\": No such file or directory", "stderr_lines": ["Error: argument \"t14ns2\" is wrong: Invalid \"netns\" value", "", "Cannot open network namespace \"t14ns2\": No such file or directory", "Cannot open network namespace \"t14ns2\": No such file or directory"], "stdout": "169: t14br2if1_m@t14VM3if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether ea:79:29:14:0e:7b brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["169: t14br2if1_m@t14VM3if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether ea:79:29:14:0e:7b brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}

TASK [Make all interfaces UP] *******************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t14ns1\" ip link set dev \"t14br1if1_m\" up\nip link set dev \"t14VM4if1_m\" up\n", "delta": "0:00:00.059303", "end": "2019-12-05 10:56:16.120231", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "rc": 0, "start": "2019-12-05 10:56:16.060928", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
changed: [localhost] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t14ns2\" ip link set dev \"t14br2if1_m\" up\nip link set dev \"t14VM3if1_m\" up\n", "delta": "0:00:00.005291", "end": "2019-12-05 10:56:16.291592", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "rc": 0, "start": "2019-12-05 10:56:16.286301", "stderr": "Cannot open network namespace \"t14ns2\": No such file or directory", "stderr_lines": ["Cannot open network namespace \"t14ns2\": No such file or directory"], "stdout": "", "stdout_lines": []}

PLAY [worker] ***********************************************************************************************************************************************

TASK [pause] ************************************************************************************************************************************************
Pausing for 60 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [99.99.99.2] => {"changed": false, "delta": 60, "echo": true, "rc": 0, "start": "2019-12-05 10:56:16.379425", "stderr": "", "stdout": "Paused for 1.0 minutes", "stop": "2019-12-05 10:57:16.379803", "user_input": ""}

TASK [Undefine Migrated VM at C2] ***************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns1', u'bridge_name': u't14br1'}, {u'vmif_m': u't14VM4if1_m', u'vm_mac': u'52:54:00:c4:9a:3d', u'name': u't14_VM4', u'vmif': u't14VM4if1', u'brif_m': u't14br1if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t14_VM4\"\n", "delta": "0:00:00.065914", "end": "2019-12-05 10:57:17.673319", "item": [{"bridge_name": "t14br1", "ns_name": "t14ns1"}, {"brif_m": "t14br1if1_m", "name": "t14_VM4", "vm_mac": "52:54:00:c4:9a:3d", "vmif": "t14VM4if1", "vmif_m": "t14VM4if1_m"}], "rc": 0, "start": "2019-12-05 10:57:17.607405", "stderr": "", "stderr_lines": [], "stdout": "Domain t14_VM4 has been undefined", "stdout_lines": ["Domain t14_VM4 has been undefined"]}
changed: [99.99.99.2] => (item=[{u'ns_name': u't14ns2', u'bridge_name': u't14br2'}, {u'vmif_m': u't14VM3if1_m', u'vm_mac': u'52:54:00:52:89:bf', u'name': u't14_VM3', u'vmif': u't14VM3if1', u'brif_m': u't14br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t14_VM3\"\n", "delta": "0:00:00.019376", "end": "2019-12-05 10:57:18.027122", "item": [{"bridge_name": "t14br2", "ns_name": "t14ns2"}, {"brif_m": "t14br2if1_m", "name": "t14_VM3", "vm_mac": "52:54:00:52:89:bf", "vmif": "t14VM3if1", "vmif_m": "t14VM3if1_m"}], "rc": 0, "start": "2019-12-05 10:57:18.007746", "stderr": "", "stderr_lines": [], "stdout": "Domain t14_VM3 has been undefined", "stdout_lines": ["Domain t14_VM3 has been undefined"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=7    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=7    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

Using /etc/ansible/ansible.cfg as config file
Using /etc/ansible/ansible.cfg as config file

PLAY [worker] ***********************************************************************************************************************************************

TASK [Detach Interface] *************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh domiflist \"t17_VM3\" | grep -w \"t17VM3if1\" ; if [ $? -eq 0 ] ; then virsh detach-interface --domain \"t17_VM3\" --type direct --config ; fi\n", "delta": "0:00:00.052912", "end": "2019-12-05 11:29:28.393957", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "rc": 0, "start": "2019-12-05 11:29:28.341045", "stderr": "", "stderr_lines": [], "stdout": "macvtap4   direct     t17VM3if1  rtl8139     52:54:00:11:ef:b3\nInterface detached successfully", "stdout_lines": ["macvtap4   direct     t17VM3if1  rtl8139     52:54:00:11:ef:b3", "Interface detached successfully"]}

TASK [Shutdown VMs] *****************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh list --state-shutoff | grep -w \"t17_VM3\" ; if [ $? -ne 0 ] ; then virsh shutdown \"t17_VM3\" ; fi\n", "delta": "0:00:00.135406", "end": "2019-12-05 11:29:28.896143", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "rc": 0, "start": "2019-12-05 11:29:28.760737", "stderr": "", "stderr_lines": [], "stdout": "Domain t17_VM3 is being shutdown", "stdout_lines": ["Domain t17_VM3 is being shutdown"]}

TASK [Remove TEMP files] ************************************************************************************************************************************
changed: [99.99.99.2] => {"changed": true, "path": "/root/.ansible/tmp/", "state": "absent"}

TASK [Migrate VM images] ************************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "8a68e5c6469a1dfc038162b53ae58e24feb63b15", "dest": "/var/lib/libvirt/images/t17_VM3.qcow2", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "md5sum": "3bb75cc1ee824df1ddc316a6ac47a347", "remote_checksum": "34c8e843acaa604f431bed0a512040ee6add4b4a", "remote_md5sum": null}

TASK [Migrate VM templates] *********************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "checksum": "c830231420dc2fdb101602e53bfe7f036accb9df", "dest": "/etc/libvirt/qemu/t17_VM3.xml", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "md5sum": "d789426919f39e18202586270c4b4c43", "remote_checksum": "c830231420dc2fdb101602e53bfe7f036accb9df", "remote_md5sum": null}

PLAY [main] *************************************************************************************************************************************************

TASK [Get list of running VMs] ******************************************************************************************************************************
ok: [localhost] => {"changed": false, "cmd": ["virsh", "list", "--name"], "delta": "0:00:00.029878", "end": "2019-12-05 11:34:19.360126", "rc": 0, "start": "2019-12-05 11:34:19.330248", "stderr": "", "stderr_lines": [], "stdout": "t1_VM1\nt1_VM2\nt1_VM3\nt2_VM2\nt2_VM3\nt14_VM1\nt14_VM4\nt14_VM3\nt17_VM1\nt17_VM2", "stdout_lines": ["t1_VM1", "t1_VM2", "t1_VM3", "t2_VM2", "t2_VM3", "t14_VM1", "t14_VM4", "t14_VM3", "t17_VM1", "t17_VM2"]}

TASK [Define VM] ********************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "created": "t17_VM3", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "warnings": ["'xml' is given - ignoring 'name'"]}

TASK [Create VM] ********************************************************************************************************************************************
ok: [localhost] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "create": 0, "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}]}

TASK [Start VM] *********************************************************************************************************************************************
ok: [localhost] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": false, "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}]}

TASK [Create VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t17br2if1_m\" ; if [ $? -ne 0 ] ; then ip link add \"t17VM3if1_m\" type veth peer name \"t17br2if1_m\" ; fi\nip link set dev \"t17br2if1_m\" up\nip link set dev \"t17VM3if1_m\" up\n", "delta": "0:00:00.032943", "end": "2019-12-05 11:34:22.152647", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "rc": 0, "start": "2019-12-05 11:34:22.119704", "stderr": "Device \"t17br2if1_m\" does not exist.", "stderr_lines": ["Device \"t17br2if1_m\" does not exist."], "stdout": "", "stdout_lines": []}

TASK [Attach VETH Pairs] ************************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip link show \"t17br2if1_m\" ; if [ $? -eq 0 ] ; then ip link set \"t17br2if1_m\" netns \"t17ns2\" ; fi\nip netns exec \"t17ns2\" brctl show \"t17br2\" | grep -w 't17br2if1_m' ; if [ $? -ne 0 ] ; then ip netns exec \"t17ns2\" brctl addif \"t17br2\" \"t17br2if1_m\" ; fi\nvirsh domiflist \"t17_VM3\" | grep -w \"t17VM3if1_m\" ; if [ $? -ne 0 ] ; then virsh attach-interface --domain \"t17_VM3\" direct \"t17VM3if1_m\" --live --persistent --mac \"52:54:00:11:ef:b3\" ; fi\n", "delta": "0:00:00.243435", "end": "2019-12-05 11:34:22.590144", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "rc": 0, "start": "2019-12-05 11:34:22.346709", "stderr": "Error: argument \"t17ns2\" is wrong: Invalid \"netns\" value\n\nCannot open network namespace \"t17ns2\": No such file or directory\nCannot open network namespace \"t17ns2\": No such file or directory", "stderr_lines": ["Error: argument \"t17ns2\" is wrong: Invalid \"netns\" value", "", "Cannot open network namespace \"t17ns2\": No such file or directory", "Cannot open network namespace \"t17ns2\": No such file or directory"], "stdout": "189: t17br2if1_m@t17VM3if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n    link/ether 66:9b:ed:7b:cd:ba brd ff:ff:ff:ff:ff:ff\nInterface attached successfully", "stdout_lines": ["189: t17br2if1_m@t17VM3if1_m: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000", "    link/ether 66:9b:ed:7b:cd:ba brd ff:ff:ff:ff:ff:ff", "Interface attached successfully"]}

TASK [Make all interfaces UP] *******************************************************************************************************************************
changed: [localhost] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "ip netns exec \"t17ns2\" ip link set dev \"t17br2if1_m\" up\nip link set dev \"t17VM3if1_m\" up\n", "delta": "0:00:00.005010", "end": "2019-12-05 11:34:22.801350", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "rc": 0, "start": "2019-12-05 11:34:22.796340", "stderr": "Cannot open network namespace \"t17ns2\": No such file or directory", "stderr_lines": ["Cannot open network namespace \"t17ns2\": No such file or directory"], "stdout": "", "stdout_lines": []}

PLAY [worker] ***********************************************************************************************************************************************

TASK [pause] ************************************************************************************************************************************************
Pausing for 60 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [99.99.99.2] => {"changed": false, "delta": 60, "echo": true, "rc": 0, "start": "2019-12-05 11:34:22.871697", "stderr": "", "stdout": "Paused for 1.0 minutes", "stop": "2019-12-05 11:35:22.871942", "user_input": ""}

TASK [Undefine Migrated VM at C2] ***************************************************************************************************************************
changed: [99.99.99.2] => (item=[{u'ns_name': u't17ns2', u'bridge_name': u't17br2'}, {u'vmif_m': u't17VM3if1_m', u'vm_mac': u'52:54:00:11:ef:b3', u'name': u't17_VM3', u'vmif': u't17VM3if1', u'brif_m': u't17br2if1_m'}]) => {"ansible_loop_var": "item", "changed": true, "cmd": "virsh undefine \"t17_VM3\"\n", "delta": "0:00:00.041695", "end": "2019-12-05 11:35:23.939199", "item": [{"bridge_name": "t17br2", "ns_name": "t17ns2"}, {"brif_m": "t17br2if1_m", "name": "t17_VM3", "vm_mac": "52:54:00:11:ef:b3", "vmif": "t17VM3if1", "vmif_m": "t17VM3if1_m"}], "rc": 0, "start": "2019-12-05 11:35:23.897504", "stderr": "", "stderr_lines": [], "stdout": "Domain t17_VM3 has been undefined", "stdout_lines": ["Domain t17_VM3 has been undefined"]}

PLAY RECAP **************************************************************************************************************************************************
99.99.99.2                 : ok=7    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=7    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

